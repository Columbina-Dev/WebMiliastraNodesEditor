<h1 id="N3uqoXtzhopuAn3jDekSup" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}" class="no-font-size"><span>一、</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>的定义</span></h1><p id="N9NL4HSr8nDKD3kAUgAjLM" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span style="color: rgba(24,26,35,1)">局内存档</span><span>是一种保存了玩家在特定关卡内产生的数据的结构。这些数据即使玩家离开了关卡，也会持续保存，且在每次进入关卡时，都会将这些数据一起带入。</span></p><p id="NXLxv-toJOLyVZNU8RF3SA" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span>例如：可以将玩家在关卡中获取到的道具列表保存为一个</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>。玩家可以在关卡中持续游玩，并在每次重新进入关卡时，都可以带入上次获取的道具</span></p><p id="NR9FvOZk5poELnbLIECmUw" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span style="color: rgba(24,26,35,1)">局内存档</span><span>的读写需要使用<span class="CardKMLink"><a target="_blank" rel="noopener noreferrer nofollow" href="/ys/ugc/tutorial//detail/mh3fmi0t99ns">结构体</a></span>以及<span class="CardKMLink"><a target="_blank" rel="noopener noreferrer nofollow" href="/ys/ugc/tutorial//detail/mhso1b9wjica">自定义变量</a></span></span></p><h1 id="NFAFhB12QrO_zn9K_fznD9" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}" class="no-font-size"><span>二、</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>相关功能</span></h1><h2 id="NcWalwmU-yiqYGVhtnBOGX" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}" class="no-font-size"><span>1.</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>的数据结构</span></h2><p id="N6gH8pQHlU-9UDhJPsrWM8" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span>每个关卡中，</span><span>创作者(奇匠)</span><span>可以配置多个</span><strong><span style="color: rgba(24,26,35,1)">局内存档模板</span></strong><span>，但每次只能启用一个</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>模板作为当前关卡使用的</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>模板</span></p><p id="NCZA6lloL7CKylD6njZe_u" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span>一个</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>模板中，包含了多个</span><span style="color: rgba(24,26,35,1)">局内存档结构体</span><span>，每个</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>都是一个定长的自定义结构体列表</span></p><p id="Njob7wZuzqDd67Vb-JJbpa" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"></p><p id="NMQ5gjimvcKeMlEidA-QpU" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span>以下为</span><span style="color: rgba(24,26,35,1)">局内存档结构体</span><span>以及</span><span style="color: rgba(24,26,35,1)">局内存档模板</span><span>的配置界面</span></p><p id="NUl8CLF08zMl9r9MzGCym7" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span><img src="https://act-webstatic.hoyoverse.com/ugc-tutorial/knowledge/sea/zh-cn/mhzcw29qjjma/94c196cc-116f-41e5-88e5-3e33b088728b.png" style="width: 1404px;aspect-ratio:1.683453237410072;"></span></p><p id="N1_uDN9EESqFBY-gP_P5oT" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"></p><p id="N0P6QWSxJWNVUXNJ0xUmP0" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span style="color: rgba(24,26,35,1)"><em>局内存档</em></span><span style="color: rgba(89,111,254,1)"><em>结构体</em></span><span>与基础结构体的使用方式基本一致，但不支持部分数据类型</span></p><p id="NCBj69X_NyWWcOcxNwMIKU" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span>以下是</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>结构体支持的数据类型：（实体、实体列表、所有类型的字典以及结构体不支持在</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>结构体中使用）</span></p><div class="table-wrapper"><table id="NFDr2rOrLPIJAy_B7o3erm" minWidth="66" class="table-wrapper" style="font-size: 16px; border-collapse: collapse;; vertical-align: top;; width:431px;" border="1" cellspacing="0"><colgroup><col style="width: 215px;"><col style="width: 215px;"></colgroup><tbody style="vertical-align: top"><tr class="table-row"><td id="NMKhQoixxjK5spKrIB3BlR" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;},&quot;bold&quot;:true}" colspan="1" rowspan="1" data-colwidth="215" style="vertical-align: top;"><p id="NLRHAieou46vRZo8S3z7sT" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;},&quot;bold&quot;:true}"><strong><span style="color: rgba(0,0,0,1)">数据类型</span></strong></p></td><td id="NmSSXs6fgMZEedj5AMYfPu" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;},&quot;bold&quot;:true}" colspan="1" rowspan="1" data-colwidth="215" style="vertical-align: top;"><p id="NwKAoiCKqn3oVv1o05GGkN" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><strong><span style="color: rgba(0,0,0,1)">列表数据类型</span></strong></p></td></tr><tr class="table-row"><td id="N-ks2fJiyu3DVXxUgRwKPj" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;}}" colspan="1" rowspan="1" data-colwidth="215" style="vertical-align: top;"><p id="NTPNLOfvZTTrwF4D9R6WlF" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;}}"><span style="color: rgba(0,0,0,1)">GUID</span></p></td><td id="NvRTdAlvgS_eD47HJqLzLG" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;}}" colspan="1" rowspan="1" data-colwidth="215" style="vertical-align: top;"><p id="NBC3SjwjgJApUbAyDvXWxO" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;}}"><span style="color: rgba(0,0,0,1)">GUID列表</span></p></td></tr><tr class="table-row"><td id="NAqxTcRPMgNUvpHaJTQ1pB" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;}}" colspan="1" rowspan="1" data-colwidth="215" style="vertical-align: top;"><p id="NfZzzks5EVMsRJtuYr0Ao1" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;}}"><span style="color: rgba(0,0,0,1)">整数</span></p></td><td id="NKxoJ7iOLY7LnxshZjDVFa" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;}}" colspan="1" rowspan="1" data-colwidth="215" style="vertical-align: top;"><p id="NXff8Ebi9YbSE2hp-75dz2" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;}}"><span style="color: rgba(0,0,0,1)">整数列表</span></p></td></tr><tr class="table-row"><td id="Nbtppm0eZgf6_Lu9atix8x" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;}}" colspan="1" rowspan="1" data-colwidth="215" style="vertical-align: top;"><p id="NI2-gJVV0bjQNZjxPqyrsD" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span style="color: rgba(0,0,0,1)">布尔值</span></p></td><td id="NBV3kRFAz_XEKSV9fdLyXV" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;}}" colspan="1" rowspan="1" data-colwidth="215" style="vertical-align: top;"><p id="NcAlLhH6Df4oC_my-1XOX3" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span style="color: rgba(0,0,0,1)">布尔值列表</span></p></td></tr><tr class="table-row"><td id="Ng9ZvxGi_KGMUPFpH4aXq5" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;}}" colspan="1" rowspan="1" data-colwidth="215" style="vertical-align: top;"><p id="Nhl_UzKK1KqyOQcHJTn5Gx" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span style="color: rgba(0,0,0,1)">浮点数</span></p></td><td id="NTEfRO0RAWyXhCzpkQcOup" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;}}" colspan="1" rowspan="1" data-colwidth="215" style="vertical-align: top;"><p id="NFxoGTCOt7vhUFwDRvAaKn" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span style="color: rgba(0,0,0,1)">浮点数列表</span></p></td></tr><tr class="table-row"><td id="NWBZ26nhIAhXIWHNmNSfRX" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;}}" colspan="1" rowspan="1" data-colwidth="215" style="vertical-align: top;"><p id="N9r-ykh7Up95WnM0o0Lo07" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span style="color: rgba(0,0,0,1)">字符串</span></p></td><td id="NBqg6dPvv9EniV3RlEMRX5" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;}}" colspan="1" rowspan="1" data-colwidth="215" style="vertical-align: top;"><p id="NgAinLlACeCrkevYobFsYe" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span style="color: rgba(0,0,0,1)">字符串列表</span></p></td></tr><tr class="table-row"><td id="Nt9AK83VLr_lyF7sPQL472" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;}}" colspan="1" rowspan="1" data-colwidth="215" style="vertical-align: top;"><p id="NLh-12pHSAu05DaJobxWuD" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span style="color: rgba(0,0,0,1)">阵营</span></p></td><td id="N0T-3NIt1LVmgmMV_cApZk" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;}}" colspan="1" rowspan="1" data-colwidth="215" style="vertical-align: top;"><p id="N6E2FCGTz1WLWMRdadSsSU" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span style="color: rgba(0,0,0,1)">阵营列表</span></p></td></tr><tr class="table-row"><td id="NGP4KZ1JGTo2cwLHSa-USm" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;}}" colspan="1" rowspan="1" data-colwidth="215" style="vertical-align: top;"><p id="NH5bQ12blVRHN1Ub4aYfMQ" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span style="color: rgba(0,0,0,1)">三维向量</span></p></td><td id="Nh-exvPn9XYYvlphhRBjFM" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;}}" colspan="1" rowspan="1" data-colwidth="215" style="vertical-align: top;"><p id="N0O6MNi9bH56UaKlVkYsQ2" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span style="color: rgba(0,0,0,1)">三维向量列表</span></p></td></tr><tr class="table-row"><td id="NrZ2OYWtTYe3qP9XDEEcQ2" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;}}" colspan="1" rowspan="1" data-colwidth="215" style="vertical-align: top;"><p id="NS1g_yJZI3IBYV1EHR8Sq9" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span style="color: rgba(0,0,0,1)">元件ID</span></p></td><td id="NXWswCsVRlfOzV8lPTaQVd" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;}}" colspan="1" rowspan="1" data-colwidth="215" style="vertical-align: top;"><p id="NajBLTh6oPRnJOYkfMkBwl" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span style="color: rgba(0,0,0,1)">元件ID列表</span></p></td></tr><tr class="table-row"><td id="NLUdSsM4fSdYIrC0cYq19E" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;}}" colspan="1" rowspan="1" data-colwidth="215" style="vertical-align: top;"><p id="NrcTsKhOWk-kC2O2MFNJnY" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span style="color: rgba(0,0,0,1)">配置ID</span></p></td><td id="NLJr00rqUeaIQR6MH4EJrC" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;}}" colspan="1" rowspan="1" data-colwidth="215" style="vertical-align: top;"><p id="N1q3FOFCMfVUVSPG1guLPj" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span style="color: rgba(0,0,0,1)">配置ID列表</span></p></td></tr></tbody></table></div><p id="NjZX3G9m8giRqVyAqAyqI9" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"></p><p id="NLhG1cr3lavMunv7EkYkbS" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span>以下为</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>结构体的配置界面，与基础结构体的配置方式基本一致</span></p><p id="N7_pEtvRN-djqIimmPWAer" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span><img src="https://act-webstatic.hoyoverse.com/ugc-tutorial/knowledge/sea/zh-cn/mhzcw29qjjma/bb7b8635-3fd8-4a14-84e0-ff478f2e3cc0.png" style="width: 1395px;aspect-ratio:1.6706586826347305;"></span></p><p id="N_PIHzVdsVEdgvnvxqaQAt" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"></p><h2 id="Nsh3NNThl_uBqngRlceSy_" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}" class="no-font-size"><span>2.</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>的写入和读取</span></h2><p id="NN1FNeb5T0vopENYBKqoIp" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span style="color: rgba(24,26,35,1)">局内存档</span><span>依赖自定义变量进行写入和读取。在定义并启用</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>模板后，模板中每个</span><span style="color: rgba(24,26,35,1)">局内存档结构体</span><span>都会在每个玩家实体上生成一个同名的自定义变量（称为</span><span style="color: rgba(251,44,54,1)"><em>局内存档变量</em></span><span>）</span></p><p id="N5YHAUJsJ-ZCR73HHry6ve" data-block-mark="{&quot;bold&quot;:true,&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><strong><span style="color: rgba(24,26,35,1)">局内存档</span><span>变量与常规自定义变量的用法完全相同，使用自定义变量相关节点进行读写</span></strong></p><p id="Nik9vh7xoaT2zXB1eRMiiw" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span>由于</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>变量与</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>的定义一一对应，所以无法直接修改玩家上的</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>变量</span></p><p id="NrMgzbWjZDklo5dWqQ1rte" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span><img src="https://act-webstatic.hoyoverse.com/ugc-tutorial/knowledge/sea/zh-cn/mhzcw29qjjma/8d4f2e5a-0cfc-4f38-b636-c6c770c31983.png" style="width: 612px;aspect-ratio:2.5394190871369293;"></span></p><p id="NcKKSVgVUiHM6Tp1bliR96" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"></p><p id="NdpePLF4whmJaw8HrXTECv" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span>在玩家进入关卡时，会根据其携带的</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>数据，将</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>数据写入玩家实体上的</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>变量。这个步骤称为</span><span style="color: rgba(251,44,54,1)"><em>读档</em></span></p><p id="N26zvlAt2ponjntRre1dWw" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span>注：将</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>数据写入</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>变量的过程会发生在实体创建前，因此玩家实体上的实体创建时事件中可以正确查询到玩家实体上的</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>变量</span></p><p id="NxmRweQTcSzOqWbhzRr9iH" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span>玩家离开关卡时，会将</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>变量的数据写入</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>，并随玩家带离关卡。这个步骤称为</span><span style="color: rgba(251,44,54,1)"><em>存档</em></span></p><h2 id="NKdUY7Zoehg438sFySlYhJ" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}" class="no-font-size"><span>3.</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>数据量限制</span></h2><p id="N8r7ALgrRL4IBV-8fyF2QG" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span>每个关卡可用的</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>数据量是有限的，由构成</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>的结构体的成员类型决定。通常来说字符串类型以及列表类型会产生较高的数据量</span></p><p id="NQ0cRTC3w0PpQMyv-9KNOY" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span>如果关卡内的总数据量超过限制，则无法进入试玩或发布，需要优化</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>的数据结构。</span></p><h3 id="N8OJE0C9M-z4k1dsGhMB-t" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}" class="no-font-size"><span>列表类型长度限制</span></h3><p id="NdvKZFYf1RTEe0nC_NFrW-" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span>因为存在</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>数据量的整体限制，</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>中所有列表类型的数据都有着最大长度的限制（与自定义</span><span style="color: rgba(24,26,35,1)">变量</span><span>不同）</span></p><p id="NR2XjIGaKC8D9nn93ndOCF" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"></p><p id="NpcpMwXvQQr2yfS2pWmD6X" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span>在运行时，</span><span style="color: rgba(24,26,35,1)">局内存档变量</span><span>中的列表数据可以超出最大长度限制存储，但在存档时，超出长度限制的列表数据会被截取到最大长度限制后存档（即保留前若干个元素，</span><span style="color: rgba(24,26,35,1)">超出长度限制</span><span>的元素会被丢弃）</span></p><p id="N32vOV_4iG1ra1QkgGC3sR" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span>这可能导致部分运行时的玩家数据无法被</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>存入，建议在写入</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>变量时对列表类型数据的长度做好校验</span></p><p id="N2VGDXkUlyMGsaHyn2WOI6" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"></p><p id="NkisB7Ckzzp1FMlMAedK5g" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span>以下图为例，在</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>结构体定义时，使用的所有列表类型数据都需要定义其长度（下图的词缀id列表长度为10，即最多存放10个整数）</span></p><p id="NGKYjn62PffYTlfpAxUIA6" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span><img src="https://act-webstatic.hoyoverse.com/ugc-tutorial/knowledge/sea/zh-cn/mhzcw29qjjma/01d01bb0-9fcc-4cf3-a392-08bcc557eb8d.png" style="width: 1399px;aspect-ratio:1.673444976076555;"></span></p><p id="NjNwtZxE82DkBB8g_ZZEWp" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"></p><p id="Nui8g0FXwFidZdI_A49L9u" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span>此外每个</span><span style="color: rgba(24,26,35,1)">局内存档模板</span><span>作为一个结构体列表，自身也有长度限制。超出长度的部分在存档时同样会被截断</span></p><p id="NrVwJhweA31i0Hw7VTmHE6" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span><img src="https://act-webstatic.hoyoverse.com/ugc-tutorial/knowledge/sea/zh-cn/mhzcw29qjjma/68a993ed-5b0d-429f-ae72-28dac21e9c6a.png" style="width: 1408px;aspect-ratio:1.6603773584905661;"></span></p><p id="NaeUkQ5BWG5Mqm-ygd-7mV" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"></p><h2 id="NqsGVHt4AD74vwcsk6k3As" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}" class="no-font-size"><span>4.</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>升级</span></h2><p id="NdMZV41oCqZpXXb83nDGTw" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span style="color: rgba(24,26,35,1)">局内存档</span><span>中可以存放玩家在游玩过程中产生的持久性数据，因此对于一个已发布的关卡，创作者(奇匠)需要小心处理</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>相关数据，以免出现玩家的数据丢失</span></p><p id="NeywmKSa1KyIZHF6Y3NEx2" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"></p><p id="NEONbp-wEFYOi6yZZVvt2g" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span>对于一个已发布的关卡，允许以以下的方式对</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>进行升级</span></p><div class="prosemirror-list-new" data-node-id="N-AkVHUQh3IT7Sf3cY-cnR" listId="9e4f6ebe" data-list-kind="bullet" data-list-indent="1" data-list-style="&apos;\e69c&apos;:0|&apos;\e69c&apos;:0|&apos;\e69c&apos;:0" auto-composed-image-block="false" style="--list-indent: 1;--list-type: &apos;\e69c&apos;;--list-content: &apos;\e69c&apos;;--ordered-list-index-size: 16px;--bullet-list-index-size: 8px;" id="N-AkVHUQh3IT7Sf3cY-cnR" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><div class="list-marker list-marker-click-target" contenteditable="false"></div><div class="list-content"><span>在已发布的</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>模板中新增</span><span style="color: rgba(24,26,35,1)">局内存档结构体</span><span>。新增的</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>数据在玩家进入关卡时会以</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>结构体中定义的默认值进行读档。</span></div></div><div class="prosemirror-list-new" data-node-id="N49FWMb1wz13JTBKP_UQ5A" listId="9e4f6ebe" data-list-kind="bullet" data-list-indent="1" data-list-style="&apos;\e69c&apos;:0|&apos;\e69c&apos;:0|&apos;\e69c&apos;:0" auto-composed-image-block="false" style="--list-indent: 1;--list-type: &apos;\e69c&apos;;--list-content: &apos;\e69c&apos;;--ordered-list-index-size: 16px;--bullet-list-index-size: 8px;" id="N49FWMb1wz13JTBKP_UQ5A" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><div class="list-marker list-marker-click-target" contenteditable="false"></div><div class="list-content"><span>在已发布的</span><span style="color: rgba(24,26,35,1)">局内存档结构体</span><span>中新增成员。新增的成员在玩家进入关卡时会以结构体中定义的默认值进行读档。</span></div></div><p id="NKXd6cgXgmC6oat-1l9_g0" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"></p><p id="NFYoVzX01Zt9eBhUyN0rHx" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span>不推荐以下的</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>操作</span></p><div class="prosemirror-list-new" data-node-id="NUnH9yLDArZr4Kw7xfaZz0" listId="b17e9921" data-list-kind="bullet" data-list-indent="1" data-list-style="&apos;\e69c&apos;:0|&apos;\e69c&apos;:0|&apos;\e69c&apos;:0" auto-composed-image-block="false" style="--list-indent: 1;--list-type: &apos;\e69c&apos;;--list-content: &apos;\e69c&apos;;--ordered-list-index-size: 16px;--bullet-list-index-size: 8px;" id="NUnH9yLDArZr4Kw7xfaZz0" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><div class="list-marker list-marker-click-target" contenteditable="false"></div><div class="list-content"><span>删除一个已发布的</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>模板，或将其替换为一个与之前</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>模板结构完全不同的新的</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>模板。</span></div></div><div class="prosemirror-list-new" data-node-id="NxAZowOJDnL_5zNA0VTWQF" listId="b17e9921" data-list-kind="bullet" data-list-indent="1" data-list-style="&apos;\e69c&apos;:0|&apos;\e69c&apos;:0|&apos;\e69c&apos;:0" auto-composed-image-block="false" style="--list-indent: 1;--list-type: &apos;\e69c&apos;;--list-content: &apos;\e69c&apos;;--ordered-list-index-size: 16px;--bullet-list-index-size: 8px;" id="NxAZowOJDnL_5zNA0VTWQF" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><div class="list-marker list-marker-click-target" contenteditable="false"></div><div class="list-content"><span>缩减已发布的</span><span style="color: rgba(24,26,35,1)">局内存档模板</span><span>的最大长度。</span></div></div><div class="prosemirror-list-new" data-node-id="NiRYteXsLyJPinF-q-9rrc" listId="b17e9921" data-list-kind="bullet" data-list-indent="1" data-list-style="&apos;\e69c&apos;:0|&apos;\e69c&apos;:0|&apos;\e69c&apos;:0" auto-composed-image-block="false" style="--list-indent: 1;--list-type: &apos;\e69c&apos;;--list-content: &apos;\e69c&apos;;--ordered-list-index-size: 16px;--bullet-list-index-size: 8px;" id="NiRYteXsLyJPinF-q-9rrc" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><div class="list-marker list-marker-click-target" contenteditable="false"></div><div class="list-content"><span>从已发布的</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>模板中修改</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>引用的结构体类型或删除已有的</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>。</span></div></div><div class="prosemirror-list-new" data-node-id="NvUNmtypRTffie_LJYnGx-" listId="b17e9921" data-list-kind="bullet" data-list-indent="1" data-list-style="&apos;\e69c&apos;:0|&apos;\e69c&apos;:0|&apos;\e69c&apos;:0" auto-composed-image-block="false" style="--list-indent: 1;--list-type: &apos;\e69c&apos;;--list-content: &apos;\e69c&apos;;--ordered-list-index-size: 16px;--bullet-list-index-size: 8px;" id="NvUNmtypRTffie_LJYnGx-" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><div class="list-marker list-marker-click-target" contenteditable="false"></div><div class="list-content"><span>对已发布的</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>结构体的成员数据类型进行修改或删除成员。</span></div></div><p id="NP9lyccU7pv1faqe12rI8K" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span>以上操作都会造成新的</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>结构与玩家已产生的</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>数据无法匹配，导致读档失败后玩家</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>数据重置</span></p><h1 id="NEFSMh6dhR3Wi0zUUrQk73" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}" class="no-font-size"><span>三、</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>相关功能的编辑入口</span></h1><h2 id="NXv7LOg_UKrx1wnf9ngd_i" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}" class="no-font-size"><span>1.</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>结构体的配置</span></h2><p id="Nr8fATiAs0ewTtArgev4Q1" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span><img src="https://act-webstatic.hoyoverse.com/ugc-tutorial/knowledge/sea/zh-cn/mhzcw29qjjma/eee6ffc6-2f8f-4b2d-9708-d6ab3edc72b0.png" style="width: 504px;aspect-ratio:0.3984189723320158;"></span></p><p id="NKdNf1rnrhDYvxCeuGvWao" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span style="color: rgba(24,26,35,1)">局内存档</span><span>结构体与基础结构体有着相似的配置方式（基础结构体配置方式见<span class="CardKMLink"><a target="_blank" rel="noopener noreferrer nofollow" href="/ys/ugc/tutorial//detail/mh3fmi0t99ns">结构体</a></span>）</span></p><p id="NlhvcRW-eLTnS2fUoiYEjH" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span><img src="https://act-webstatic.hoyoverse.com/ugc-tutorial/knowledge/sea/zh-cn/mhzcw29qjjma/ebb2d3de-4ca4-4285-a5e7-61bf1e62df57.png" style="width: 1412px;aspect-ratio:1.6829558998808105;"></span></p><p id="Nzc76xXxgNASdapF9t1kos" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"></p><p id="N-gPRJZ5pwc59PwR9thVDL" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span>主要的区别是</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>结构体中使用的列表类型成员需要确定其长度。需要以增加元素的方式为其确定长度</span></p><p id="NzzLqNQtjYcz6AcbEd-32z" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span><img src="https://act-webstatic.hoyoverse.com/ugc-tutorial/knowledge/sea/zh-cn/mhzcw29qjjma/531af301-8a3c-4b86-ba87-55f72feea1ff.png" style="width: 1412px;aspect-ratio:1.6789536266349583;"></span></p><p id="NGVIroG1RzcfWDAgFaLzkZ" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"></p><h2 id="NT5tLzIj-ogr71wtNWzEQG" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}" class="no-font-size"><span>2.</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>以及</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>模板的配置</span></h2><p id="NIcdu9_zlfPEggTb-RKwpk" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span>从系统菜单内可以找到【</span><span style="color: rgba(24,26,35,1)">局内存档管理】</span></p><p id="NTyTGHd8J2qtZrg_8XA7da" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span><img src="https://act-webstatic.hoyoverse.com/ugc-tutorial/knowledge/sea/zh-cn/mhzcw29qjjma/ac98365d-18dd-49e6-abab-5c85e7894140.png" style="width: 502px;aspect-ratio:0.417985012489592;"></span></p><h3 id="NBIw1GqPwN9prg-YvgxIdJ" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}" class="no-font-size"><span>(1)</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>编辑</span></h3><p id="NbsntEEFMGgyErS2IWp4wV" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span>左侧为已创建的所有</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>模板。创作者(奇匠)可以创建多个模板，但最终使用的只能有一个模板，可以</span><span style="color: rgba(24,26,35,1)">通过打开启用局内存档开关</span><span>来启用当前的模板</span></p><p id="NB1-PssGDQ2IZcXMm2V4YT" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span>右侧为该</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>模板的详细配置，如前文所述，每个模板里包含多条</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>数据。每条</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>数据可以选择需要使用的</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>结构体，并为其定义最大长度</span></p><p id="NC4DmLC9DePEtkKWJfuNsV" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span><img src="https://act-webstatic.hoyoverse.com/ugc-tutorial/knowledge/sea/zh-cn/mhzcw29qjjma/0a545152-708a-4179-9867-5ea4d2bd9398.png" style="width: 1410px;aspect-ratio:1.688622754491018;"></span></p><p id="NRkuPmrodds_MuBF0Sea_y" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"></p><h3 id="N3pZ7-pf1CaCUvG3AbCkdB" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}" class="no-font-size"><span>(2)对比模板功能</span></h3><p id="NJEAfOTUvDgfkkjGzFaUew" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span>可以使用对比模板功能将两个模板的差异进行对比。这通常用于</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>模板的升级（升级要求升级后的模板相对升级前的模板是纯增量或完全相同，不能产生数据结构的删除或修改）</span></p><p id="NeMX4Xz370WiOG_LAJZbWg" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"></p><p id="NqigoSKnsRJvDmKJSCFfah" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span>需要使用对比功能，需要先将要对比的</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>模板设为对比模板。右键点击后，选择【设为对比模板】</span></p><p id="Nef9bRmkcA3pfXC_8_ygZ9" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span><img src="https://act-webstatic.hoyoverse.com/ugc-tutorial/knowledge/sea/zh-cn/mhzcw29qjjma/1966c3d3-b47f-4ac6-974c-6d56420daecf.png" style="width: 529px;aspect-ratio:1.011472275334608;"></span></p><p id="NnfA-2CSUOjXXAQ3mO4J7n" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span>然后在当前使用的模板，点击对比模板</span></p><p id="N2TQTWx2dBanvmJ-nd4eZW" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span><img src="https://act-webstatic.hoyoverse.com/ugc-tutorial/knowledge/sea/zh-cn/mhzcw29qjjma/aaa66a48-5e49-4357-bc83-ee57bdacb210.png" style="width: 1402px;aspect-ratio:1.6750298685782556;"></span></p><p id="NE3QseF7VnZsD68bvyn72b" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"></p><p id="NIdYW4mk6C94YPDT8uklN4" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span>如果当前模板不是对比模板的正确升级（</span><span style="color: rgba(24,26,35,1)">局内存档</span><span>结构完全相同，且结构体成员为增量），则会弹出以下提示</span></p><p id="NV0MhMHS5bGs0uXOG3vkJV" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;}}"><span><img src="https://act-webstatic.hoyoverse.com/ugc-tutorial/knowledge/sea/zh-cn/mhzcw29qjjma/6e3d0f07-530e-4cb2-9e3e-cdba0ae419d4.png" style="width: 600px;aspect-ratio:2.380952380952381;"></span></p>