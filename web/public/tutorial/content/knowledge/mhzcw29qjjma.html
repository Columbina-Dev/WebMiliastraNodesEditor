<h1 id="N3uqoXtzhopuAn3jDekSup" data-block-mark="{}" class="no-font-size">一、<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>的定义</h1><p id="N9NL4HSr8nDKD3kAUgAjLM" data-block-mark="{}"><span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>是一种保存了玩家在特定关卡内产生的数据的结构。这些数据即使玩家离开了关卡，也会持续保存，且在每次进入关卡时，都会将这些数据一起带入。</p><p id="NXLxv-toJOLyVZNU8RF3SA" data-block-mark="{}">例如：可以将玩家在关卡中获取到的道具列表保存为一个<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>。玩家可以在关卡中持续游玩，并在每次重新进入关卡时，都可以带入上次获取的道具</p><p id="NR9FvOZk5poELnbLIECmUw" data-block-mark="{}"><span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>的读写需要使用<span class="CardKMLink"><a target="_blank" rel="noopener noreferrer nofollow" href="/ys/ugc/tutorial//detail/mh3fmi0t99ns">结构体</a></span>以及<span class="CardKMLink"><a target="_blank" rel="noopener noreferrer nofollow" href="/ys/ugc/tutorial//detail/mhso1b9wjica">自定义变量</a></span></p><h1 id="NFAFhB12QrO_zn9K_fznD9" data-block-mark="{}" class="no-font-size">二、<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>相关功能</h1><h2 id="NcWalwmU-yiqYGVhtnBOGX" data-block-mark="{}" class="no-font-size">1.<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>的数据结构</h2><p id="N6gH8pQHlU-9UDhJPsrWM8" data-block-mark="{}">每个关卡中，创作者可以配置多个<strong><span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span><span style="color: rgba(24,26,35,1)">模板</span></strong>，但每次只能启用一个<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>模板作为当前关卡使用的<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>模板</p><p id="NCZA6lloL7CKylD6njZe_u" data-block-mark="{}">一个<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>模板中，包含了多个<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档结构体</span>，每个<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>都是一个定长的自定义结构体列表</p><p id="Njob7wZuzqDd67Vb-JJbpa" data-block-mark="{}"></p><p id="NMQ5gjimvcKeMlEidA-QpU" data-block-mark="{}">以下为<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档结构体</span>以及<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档模板</span>的配置界面</p><p id="NUl8CLF08zMl9r9MzGCym7" data-block-mark="{}"><img src="https://act-webstatic.hoyoverse.com/ugc-tutorial/knowledge/sea/zh-cn/mhzcw29qjjma/8529d929-0e7d-4b81-9377-702df82290c8.png" style="width: 972px;aspect-ratio:1.6146179401993355;"></p><p id="N1_uDN9EESqFBY-gP_P5oT" data-block-mark="{}"></p><p id="N0P6QWSxJWNVUXNJ0xUmP0" data-block-mark="{}"><span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)"><em>局内存档</em></span><span style="color: rgba(89,111,254,1)"><em>结构体</em></span>与基础结构体的使用方式基本一致，但不支持部分数据类型</p><p id="NCBj69X_NyWWcOcxNwMIKU" data-block-mark="{}">以下是<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>结构体支持的数据类型：（实体、实体列表、所有类型的字典以及结构体不支持在<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>结构体中使用）</p><div class="table-wrapper"><table id="NFDr2rOrLPIJAy_B7o3erm" minWidth="66" class="table-wrapper" style="font-size: 16px; border-collapse: collapse;; vertical-align: top;; width:431px;" border="1" cellspacing="0"><colgroup><col style="width: 215px;"><col style="width: 215px;"></colgroup><tbody style="vertical-align: top"><tr class="table-row"><td id="NMKhQoixxjK5spKrIB3BlR" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;},&quot;bold&quot;:true}" colspan="1" rowspan="1" data-colwidth="215" style="vertical-align: top;"><p id="NLRHAieou46vRZo8S3z7sT" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;},&quot;bold&quot;:true}"><strong><span style="color: rgba(0,0,0,1)">数据类型</span></strong></p></td><td id="NmSSXs6fgMZEedj5AMYfPu" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;},&quot;bold&quot;:true}" colspan="1" rowspan="1" data-colwidth="215" style="vertical-align: top;"><p id="NwKAoiCKqn3oVv1o05GGkN" data-block-mark="{}"><strong><span style="color: rgba(0,0,0,1)">列表数据类型</span></strong></p></td></tr><tr class="table-row"><td id="N-ks2fJiyu3DVXxUgRwKPj" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;}}" colspan="1" rowspan="1" data-colwidth="215" style="vertical-align: top;"><p id="NTPNLOfvZTTrwF4D9R6WlF" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;}}"><span style="color: rgba(0,0,0,1)">GUID</span></p></td><td id="NvRTdAlvgS_eD47HJqLzLG" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;}}" colspan="1" rowspan="1" data-colwidth="215" style="vertical-align: top;"><p id="NBC3SjwjgJApUbAyDvXWxO" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;}}"><span style="color: rgba(0,0,0,1)">GUID列表</span></p></td></tr><tr class="table-row"><td id="NAqxTcRPMgNUvpHaJTQ1pB" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;}}" colspan="1" rowspan="1" data-colwidth="215" style="vertical-align: top;"><p id="NfZzzks5EVMsRJtuYr0Ao1" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;}}"><span style="color: rgba(0,0,0,1)">整数</span></p></td><td id="NKxoJ7iOLY7LnxshZjDVFa" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;}}" colspan="1" rowspan="1" data-colwidth="215" style="vertical-align: top;"><p id="NXff8Ebi9YbSE2hp-75dz2" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;}}"><span style="color: rgba(0,0,0,1)">整数列表</span></p></td></tr><tr class="table-row"><td id="Nbtppm0eZgf6_Lu9atix8x" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;}}" colspan="1" rowspan="1" data-colwidth="215" style="vertical-align: top;"><p id="NI2-gJVV0bjQNZjxPqyrsD" data-block-mark="{}"><span style="color: rgba(0,0,0,1)">布尔值</span></p></td><td id="NBV3kRFAz_XEKSV9fdLyXV" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;}}" colspan="1" rowspan="1" data-colwidth="215" style="vertical-align: top;"><p id="NcAlLhH6Df4oC_my-1XOX3" data-block-mark="{}"><span style="color: rgba(0,0,0,1)">布尔值列表</span></p></td></tr><tr class="table-row"><td id="Ng9ZvxGi_KGMUPFpH4aXq5" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;}}" colspan="1" rowspan="1" data-colwidth="215" style="vertical-align: top;"><p id="Nhl_UzKK1KqyOQcHJTn5Gx" data-block-mark="{}"><span style="color: rgba(0,0,0,1)">浮点数</span></p></td><td id="NTEfRO0RAWyXhCzpkQcOup" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;}}" colspan="1" rowspan="1" data-colwidth="215" style="vertical-align: top;"><p id="NFxoGTCOt7vhUFwDRvAaKn" data-block-mark="{}"><span style="color: rgba(0,0,0,1)">浮点数列表</span></p></td></tr><tr class="table-row"><td id="NWBZ26nhIAhXIWHNmNSfRX" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;}}" colspan="1" rowspan="1" data-colwidth="215" style="vertical-align: top;"><p id="N9r-ykh7Up95WnM0o0Lo07" data-block-mark="{}"><span style="color: rgba(0,0,0,1)">字符串</span></p></td><td id="NBqg6dPvv9EniV3RlEMRX5" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;}}" colspan="1" rowspan="1" data-colwidth="215" style="vertical-align: top;"><p id="NgAinLlACeCrkevYobFsYe" data-block-mark="{}"><span style="color: rgba(0,0,0,1)">字符串列表</span></p></td></tr><tr class="table-row"><td id="Nt9AK83VLr_lyF7sPQL472" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;}}" colspan="1" rowspan="1" data-colwidth="215" style="vertical-align: top;"><p id="NLh-12pHSAu05DaJobxWuD" data-block-mark="{}"><span style="color: rgba(0,0,0,1)">阵营</span></p></td><td id="N0T-3NIt1LVmgmMV_cApZk" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;}}" colspan="1" rowspan="1" data-colwidth="215" style="vertical-align: top;"><p id="N6E2FCGTz1WLWMRdadSsSU" data-block-mark="{}"><span style="color: rgba(0,0,0,1)">阵营列表</span></p></td></tr><tr class="table-row"><td id="NGP4KZ1JGTo2cwLHSa-USm" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;}}" colspan="1" rowspan="1" data-colwidth="215" style="vertical-align: top;"><p id="NH5bQ12blVRHN1Ub4aYfMQ" data-block-mark="{}"><span style="color: rgba(0,0,0,1)">三维向量</span></p></td><td id="Nh-exvPn9XYYvlphhRBjFM" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;}}" colspan="1" rowspan="1" data-colwidth="215" style="vertical-align: top;"><p id="N0O6MNi9bH56UaKlVkYsQ2" data-block-mark="{}"><span style="color: rgba(0,0,0,1)">三维向量列表</span></p></td></tr><tr class="table-row"><td id="NrZ2OYWtTYe3qP9XDEEcQ2" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;}}" colspan="1" rowspan="1" data-colwidth="215" style="vertical-align: top;"><p id="NS1g_yJZI3IBYV1EHR8Sq9" data-block-mark="{}"><span style="color: rgba(0,0,0,1)">元件ID</span></p></td><td id="NXWswCsVRlfOzV8lPTaQVd" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;}}" colspan="1" rowspan="1" data-colwidth="215" style="vertical-align: top;"><p id="NajBLTh6oPRnJOYkfMkBwl" data-block-mark="{}"><span style="color: rgba(0,0,0,1)">元件ID列表</span></p></td></tr><tr class="table-row"><td id="NLUdSsM4fSdYIrC0cYq19E" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;}}" colspan="1" rowspan="1" data-colwidth="215" style="vertical-align: top;"><p id="NrcTsKhOWk-kC2O2MFNJnY" data-block-mark="{}"><span style="color: rgba(0,0,0,1)">配置ID</span></p></td><td id="NLJr00rqUeaIQR6MH4EJrC" data-block-mark="{&quot;textStyle&quot;:{&quot;backgroundColor&quot;:&quot;&quot;,&quot;color&quot;:&quot;rgba(0,0,0,1)&quot;}}" colspan="1" rowspan="1" data-colwidth="215" style="vertical-align: top;"><p id="N1q3FOFCMfVUVSPG1guLPj" data-block-mark="{}"><span style="color: rgba(0,0,0,1)">配置ID列表</span></p></td></tr></tbody></table></div><p id="NjZX3G9m8giRqVyAqAyqI9" data-block-mark="{}"></p><p id="NLhG1cr3lavMunv7EkYkbS" data-block-mark="{}">以下为<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>结构体的配置界面，与基础结构体的配置方式基本一致</p><p id="N7_pEtvRN-djqIimmPWAer" data-block-mark="{}"><img src="https://act-webstatic.hoyoverse.com/ugc-tutorial/knowledge/sea/zh-cn/mhzcw29qjjma/e2614e7a-461c-4ddb-bc4b-52bdf9f6e7f5.png" style="width: 914px;aspect-ratio:1.6648451730418943;"></p><p id="N_PIHzVdsVEdgvnvxqaQAt" data-block-mark="{}"></p><h2 id="Nsh3NNThl_uBqngRlceSy_" data-block-mark="{}" class="no-font-size">2.<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>的写入和读取</h2><p id="NN1FNeb5T0vopENYBKqoIp" data-block-mark="{}"><span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>依赖自定义变量进行写入和读取。在定义并启用<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>模板后，模板中每个<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档结构体</span>都会在每个玩家实体上生成一个同名的自定义变量（称为<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)"><em>局内存档</em></span><span style="color: rgba(251,44,54,1)"><em>变量</em></span>）</p><p id="N5YHAUJsJ-ZCR73HHry6ve" data-block-mark="{&quot;bold&quot;:true}"><strong><span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>变量与常规自定义变量的用法完全相同，使用自定义变量相关节点进行读写</strong></p><p id="Nik9vh7xoaT2zXB1eRMiiw" data-block-mark="{}">由于<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>变量与<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>的定义一一对应，所以无法直接修改玩家上的<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>变量</p><p id="NrMgzbWjZDklo5dWqQ1rte" data-block-mark="{}"><img src="https://act-webstatic.hoyoverse.com/ugc-tutorial/knowledge/sea/zh-cn/mhzcw29qjjma/c5231585-e863-4d8f-a7ba-9763b3a33e70.png" style="width: 488px;aspect-ratio:1.3593314763231197;"></p><p id="NcKKSVgVUiHM6Tp1bliR96" data-block-mark="{}"></p><p id="NdpePLF4whmJaw8HrXTECv" data-block-mark="{}">在玩家进入关卡时，会根据其携带的<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>数据，将<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>数据写入玩家实体上的<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>变量。这个步骤称为<span style="color: rgba(251,44,54,1)"><em>读档</em></span></p><p id="N26zvlAt2ponjntRre1dWw" data-block-mark="{}">注：将<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>数据写入<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>变量的过程会发生在实体创建前，因此玩家实体上的实体创建时事件中可以正确查询到玩家实体上的<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>变量</p><p id="NxmRweQTcSzOqWbhzRr9iH" data-block-mark="{}">玩家离开关卡时，会将<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>变量的数据写入<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>，并随玩家带离关卡。这个步骤称为<span style="color: rgba(251,44,54,1)"><em>存档</em></span></p><h2 id="NKdUY7Zoehg438sFySlYhJ" data-block-mark="{}" class="no-font-size">3.<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>数据量限制</h2><p id="N8r7ALgrRL4IBV-8fyF2QG" data-block-mark="{}">每个关卡可用的<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>数据量是有限的，由构成<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>的结构体的成员类型决定。通常来说字符串类型以及列表类型会产生较高的数据量</p><p id="NQ0cRTC3w0PpQMyv-9KNOY" data-block-mark="{}">如果关卡内的总数据量超过限制，则无法进入试玩或发布，需要优化<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>的数据结构。</p><h3 id="N8OJE0C9M-z4k1dsGhMB-t" data-block-mark="{}" class="no-font-size">列表类型长度限制</h3><p id="NdvKZFYf1RTEe0nC_NFrW-" data-block-mark="{}">因为存在<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>数据量的整体限制，<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>中所有列表类型的数据都有着最大长度的限制（与自定义<span style="color: rgba(24,26,35,1)">变量</span>不同）</p><p id="NR2XjIGaKC8D9nn93ndOCF" data-block-mark="{}"></p><p id="NpcpMwXvQQr2yfS2pWmD6X" data-block-mark="{}">在运行时，<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span><span style="color: rgba(24,26,35,1)">变量</span>中的列表数据可以超出最大长度限制存储，但在存档时，超出长度限制的列表数据会被截取到最大长度限制后存档（即保留前若干个元素，<span style="color: rgba(24,26,35,1)">超出长度限制</span>的元素会被丢弃）</p><p id="N32vOV_4iG1ra1QkgGC3sR" data-block-mark="{}">这可能导致部分运行时的玩家数据无法被<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>存入，建议在写入<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>变量时对列表类型数据的长度做好校验</p><p id="N2VGDXkUlyMGsaHyn2WOI6" data-block-mark="{}"></p><p id="NkisB7Ckzzp1FMlMAedK5g" data-block-mark="{}">以下图为例，在<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>结构体定义时，使用的所有列表类型数据都需要定义其长度（下图的词缀id列表长度为10，即最多存放10个整数）</p><p id="NGKYjn62PffYTlfpAxUIA6" data-block-mark="{}"><img src="https://act-webstatic.hoyoverse.com/ugc-tutorial/knowledge/sea/zh-cn/mhzcw29qjjma/37db0581-357b-4f05-aee2-c0ad4c20fd5e.png" style="width: 886px;aspect-ratio:1.6654135338345866;"></p><p id="NjNwtZxE82DkBB8g_ZZEWp" data-block-mark="{}"></p><p id="Nui8g0FXwFidZdI_A49L9u" data-block-mark="{}">此外每个<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档模板</span>作为一个结构体列表，自身也有长度限制。超出长度的部分在存档时同样会被截断</p><p id="NrVwJhweA31i0Hw7VTmHE6" data-block-mark="{}"><img src="https://act-webstatic.hoyoverse.com/ugc-tutorial/knowledge/sea/zh-cn/mhzcw29qjjma/10c249e4-acc8-47aa-9e48-aa1d047dc4f1.png" style="width: 1096px;aspect-ratio:1.6992248062015505;"></p><p id="NaeUkQ5BWG5Mqm-ygd-7mV" data-block-mark="{}"></p><h2 id="NqsGVHt4AD74vwcsk6k3As" data-block-mark="{}" class="no-font-size">4.<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>升级</h2><p id="NdMZV41oCqZpXXb83nDGTw" data-block-mark="{}"><span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>中可以存放玩家在游玩过程中产生的持久性数据，因此对于一个已发布的关卡，创作者需要小心处理<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>相关数据，以免出现玩家的数据丢失</p><p id="NeywmKSa1KyIZHF6Y3NEx2" data-block-mark="{}"></p><p id="NEONbp-wEFYOi6yZZVvt2g" data-block-mark="{}">对于一个已发布的关卡，允许以以下的方式对<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>进行升级</p><div class="prosemirror-list-new" data-node-id="N-AkVHUQh3IT7Sf3cY-cnR" listId="9e4f6ebe" data-list-kind="bullet" data-list-indent="1" data-list-style="&apos;\e69c&apos;:0|&apos;\e69c&apos;:0|&apos;\e69c&apos;:0" auto-composed-image-block="false" style="--list-indent: 1;--list-type: &apos;\e69c&apos;;--list-content: &apos;\e69c&apos;;--ordered-list-index-size: 16px;--bullet-list-index-size: 8px;" id="N-AkVHUQh3IT7Sf3cY-cnR" data-block-mark="{}"><div class="list-marker list-marker-click-target" contenteditable="false"></div><div class="list-content">在已发布的<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>模板中新增<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档结构体</span>。新增的<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>数据在玩家进入关卡时会以<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>结构体中定义的默认值进行读档。</div></div><div class="prosemirror-list-new" data-node-id="N49FWMb1wz13JTBKP_UQ5A" listId="9e4f6ebe" data-list-kind="bullet" data-list-indent="1" data-list-style="&apos;\e69c&apos;:0|&apos;\e69c&apos;:0|&apos;\e69c&apos;:0" auto-composed-image-block="false" style="--list-indent: 1;--list-type: &apos;\e69c&apos;;--list-content: &apos;\e69c&apos;;--ordered-list-index-size: 16px;--bullet-list-index-size: 8px;" id="N49FWMb1wz13JTBKP_UQ5A" data-block-mark="{}"><div class="list-marker list-marker-click-target" contenteditable="false"></div><div class="list-content">在已发布的<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档结构体</span>中新增成员。新增的成员在玩家进入关卡时会以结构体中定义的默认值进行读档。</div></div><p id="NKXd6cgXgmC6oat-1l9_g0" data-block-mark="{}"></p><p id="NFYoVzX01Zt9eBhUyN0rHx" data-block-mark="{}">不推荐以下的<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>操作</p><div class="prosemirror-list-new" data-node-id="NUnH9yLDArZr4Kw7xfaZz0" listId="b17e9921" data-list-kind="bullet" data-list-indent="1" data-list-style="&apos;\e69c&apos;:0|&apos;\e69c&apos;:0|&apos;\e69c&apos;:0" auto-composed-image-block="false" style="--list-indent: 1;--list-type: &apos;\e69c&apos;;--list-content: &apos;\e69c&apos;;--ordered-list-index-size: 16px;--bullet-list-index-size: 8px;" id="NUnH9yLDArZr4Kw7xfaZz0" data-block-mark="{}"><div class="list-marker list-marker-click-target" contenteditable="false"></div><div class="list-content">删除一个已发布的<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>模板，或将其替换为一个与之前<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>模板结构完全不同的新的<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>模板。</div></div><div class="prosemirror-list-new" data-node-id="NxAZowOJDnL_5zNA0VTWQF" listId="b17e9921" data-list-kind="bullet" data-list-indent="1" data-list-style="&apos;\e69c&apos;:0|&apos;\e69c&apos;:0|&apos;\e69c&apos;:0" auto-composed-image-block="false" style="--list-indent: 1;--list-type: &apos;\e69c&apos;;--list-content: &apos;\e69c&apos;;--ordered-list-index-size: 16px;--bullet-list-index-size: 8px;" id="NxAZowOJDnL_5zNA0VTWQF" data-block-mark="{}"><div class="list-marker list-marker-click-target" contenteditable="false"></div><div class="list-content">缩减已发布的<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档模板</span>的最大长度。</div></div><div class="prosemirror-list-new" data-node-id="NiRYteXsLyJPinF-q-9rrc" listId="b17e9921" data-list-kind="bullet" data-list-indent="1" data-list-style="&apos;\e69c&apos;:0|&apos;\e69c&apos;:0|&apos;\e69c&apos;:0" auto-composed-image-block="false" style="--list-indent: 1;--list-type: &apos;\e69c&apos;;--list-content: &apos;\e69c&apos;;--ordered-list-index-size: 16px;--bullet-list-index-size: 8px;" id="NiRYteXsLyJPinF-q-9rrc" data-block-mark="{}"><div class="list-marker list-marker-click-target" contenteditable="false"></div><div class="list-content">从已发布的<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>模板中修改<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>引用的结构体类型或删除已有的<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>。</div></div><div class="prosemirror-list-new" data-node-id="NvUNmtypRTffie_LJYnGx-" listId="b17e9921" data-list-kind="bullet" data-list-indent="1" data-list-style="&apos;\e69c&apos;:0|&apos;\e69c&apos;:0|&apos;\e69c&apos;:0" auto-composed-image-block="false" style="--list-indent: 1;--list-type: &apos;\e69c&apos;;--list-content: &apos;\e69c&apos;;--ordered-list-index-size: 16px;--bullet-list-index-size: 8px;" id="NvUNmtypRTffie_LJYnGx-" data-block-mark="{}"><div class="list-marker list-marker-click-target" contenteditable="false"></div><div class="list-content">对已发布的<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>结构体的成员数据类型进行修改或删除成员。</div></div><p id="NP9lyccU7pv1faqe12rI8K" data-block-mark="{}">以上操作都会造成新的<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>结构与玩家已产生的<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>数据无法匹配，导致读档失败后玩家<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>数据重置</p><h1 id="NEFSMh6dhR3Wi0zUUrQk73" data-block-mark="{}" class="no-font-size">三、<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>相关功能的编辑入口</h1><h2 id="NXv7LOg_UKrx1wnf9ngd_i" data-block-mark="{}" class="no-font-size">1.<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>结构体的配置</h2><p id="NKdNf1rnrhDYvxCeuGvWao" data-block-mark="{}"><span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>结构体与基础结构体有着相似的配置方式（基础结构体配置方式见<span class="CardKMLink"><a target="_blank" rel="noopener noreferrer nofollow" href="/ys/ugc/tutorial//detail/mh3fmi0t99ns">结构体</a></span>）</p><p id="NlhvcRW-eLTnS2fUoiYEjH" data-block-mark="{}"><img src="https://act-webstatic.hoyoverse.com/ugc-tutorial/knowledge/sea/zh-cn/mhzcw29qjjma/32f6349a-fd13-4edb-a6e6-8aa9ccdfc4d5.png" style="width: 1116px;aspect-ratio:1.8235294117647058;"></p><p id="Nzc76xXxgNASdapF9t1kos" data-block-mark="{}"></p><p id="N-gPRJZ5pwc59PwR9thVDL" data-block-mark="{}">主要的区别是<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>结构体中使用的列表类型成员需要确定其长度。需要以增加元素的方式为其确定长度</p><p id="NzzLqNQtjYcz6AcbEd-32z" data-block-mark="{}"><img src="https://act-webstatic.hoyoverse.com/ugc-tutorial/knowledge/sea/zh-cn/mhzcw29qjjma/935fde63-6f39-4e3d-82aa-74a6c35af976.png" style="width: 1120px;aspect-ratio:1.6374269005847952;"></p><p id="NGVIroG1RzcfWDAgFaLzkZ" data-block-mark="{}"></p><h2 id="NT5tLzIj-ogr71wtNWzEQG" data-block-mark="{}" class="no-font-size">2.<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>以及<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>模板的配置</h2><p id="NIcdu9_zlfPEggTb-RKwpk" data-block-mark="{}">从系统菜单内可以找到【<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档管理】</span></p><p id="NTyTGHd8J2qtZrg_8XA7da" data-block-mark="{}"><img src="https://act-webstatic.hoyoverse.com/ugc-tutorial/knowledge/sea/zh-cn/mhzcw29qjjma/99fa2836-784e-4aeb-9541-911aaa5e4fd1.png" style="width: 1451px;aspect-ratio:1.8297604035308954;"></p><p id="NdbCsud3r8-CtHl1Df2LK-" data-block-mark="{}"></p><h3 id="NBIw1GqPwN9prg-YvgxIdJ" data-block-mark="{}" class="no-font-size">(1)<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>编辑</h3><p id="NbsntEEFMGgyErS2IWp4wV" data-block-mark="{}">左侧为已创建的所有<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>模板。创作者可以创建多个模板，但最终使用的只能有一个模板，可以<span style="color: rgba(24,26,35,1)">通过打开启用</span><span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span><span style="color: rgba(24,26,35,1)">开关</span>来启用当前的模板</p><p id="NB1-PssGDQ2IZcXMm2V4YT" data-block-mark="{}">右侧为该<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>模板的详细配置，如前文所述，每个模板里包含多条<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>数据。每条<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>数据可以选择需要使用的<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>结构体，并为其定义最大长度</p><p id="NC4DmLC9DePEtkKWJfuNsV" data-block-mark="{}"><img src="https://act-webstatic.hoyoverse.com/ugc-tutorial/knowledge/sea/zh-cn/mhzcw29qjjma/4e9ca140-89a0-4b2a-98ee-9b0c2932b56b.png" style="width: 1422px;aspect-ratio:1.8160919540229885;"></p><p id="NRkuPmrodds_MuBF0Sea_y" data-block-mark="{}"></p><h3 id="N3pZ7-pf1CaCUvG3AbCkdB" data-block-mark="{}" class="no-font-size">(2)对比模板功能</h3><p id="NJEAfOTUvDgfkkjGzFaUew" data-block-mark="{}">可以使用对比模板功能将两个模板的差异进行对比。这通常用于<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>模板的升级（升级要求升级后的模板相对升级前的模板是纯增量或完全相同，不能产生数据结构的删除或修改）</p><p id="NeMX4Xz370WiOG_LAJZbWg" data-block-mark="{}"></p><p id="NqigoSKnsRJvDmKJSCFfah" data-block-mark="{}">需要使用对比功能，需要先将要对比的<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>模板设为对比模板。右键点击后，选择【设为对比模板】</p><p id="Nef9bRmkcA3pfXC_8_ygZ9" data-block-mark="{}"><img src="https://act-webstatic.hoyoverse.com/ugc-tutorial/knowledge/sea/zh-cn/mhzcw29qjjma/51b6c74a-0c9f-4c3a-a6d9-185e099b10fd.png" style="width: 333px;aspect-ratio:1.7619047619047619;"></p><p id="NnfA-2CSUOjXXAQ3mO4J7n" data-block-mark="{}">然后在当前使用的模板，点击对比模板</p><p id="N2TQTWx2dBanvmJ-nd4eZW" data-block-mark="{}"><img src="https://act-webstatic.hoyoverse.com/ugc-tutorial/knowledge/sea/zh-cn/mhzcw29qjjma/375bb189-3f16-4db5-99c3-700785918a7a.png" style="width: 1059px;aspect-ratio:1.6572769953051643;"></p><p id="NE3QseF7VnZsD68bvyn72b" data-block-mark="{}"></p><p id="NIdYW4mk6C94YPDT8uklN4" data-block-mark="{}">如果当前模板不是对比模板的正确升级（<span style="background-color: #FEF9C2;; color: rgba(24,26,35,1)">局内存档</span>结构完全相同，且结构体成员为增量），则会弹出以下提示</p><p id="NV0MhMHS5bGs0uXOG3vkJV" data-block-mark="{}"><img src="https://act-webstatic.hoyoverse.com/ugc-tutorial/knowledge/sea/zh-cn/mhzcw29qjjma/7b5aba59-ee71-4323-979d-2ce7805b2f31.png" style="width: 489px;aspect-ratio:2.0808510638297872;"></p>